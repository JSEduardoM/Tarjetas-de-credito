library(ggplot2)
library(dplyr)
library(caret)
library(pROC)
library(corrplot)
# Definir ruta del archivo (ajustar si es necesario)
ruta_csv <- "c:/Users/User/Documents/SEMESTRE IX/CIENCIA DE DATOS II/TARJETAS DE CREDITO/DatosAERcreditcarddataxlsx.csv"
# Cargar datos
data <- read.csv(ruta_csv)
# Vista preliminar
print("Primeras filas del dataset:")
head(data)
str(data)
# Convertir variables categóricas a factores
# La variable objetivo parece ser 'card' (yes/no)
data$card <- as.factor(data$card)
data$owner <- as.factor(data$owner)
data$selfemp <- as.factor(data$selfemp)
# Verificar valores nulos
print("Valores nulos por columna:")
colSums(is.na(data))
# Resumen estadístico
summary(data)
# Distribución de la variable objetivo
png("plot_distribution.png")
g1 <- ggplot(data, aes(x = card, fill = card)) +
geom_bar() +
labs(title = "Distribución de la Variable Objetivo (Card)", x = "Aprobación de Tarjeta", y = "Conteo") +
theme_minimal()
print(g1)
dev.off()
# Relación Income vs Card
png("plot_income_card.png")
g2 <- ggplot(data, aes(x = card, y = income, fill = card)) +
geom_boxplot() +
labs(title = "Ingresos (Income) según Aprobación de Tarjeta", x = "Tarjeta", y = "Ingresos") +
theme_minimal()
print(g2)
dev.off()
# Relación Age vs Card
png("plot_age_card.png")
g3 <- ggplot(data, aes(x = card, y = age, fill = card)) +
geom_boxplot() +
labs(title = "Edad (Age) según Aprobación de Tarjeta", x = "Tarjeta", y = "Edad") +
theme_minimal()
print(g3)
dev.off()
# Correlaciones numéricas
png("plot_correlation.png")
numeric_vars <- data %>% select_if(is.numeric)
cor_matrix <- cor(numeric_vars)
corrplot(cor_matrix, method = "circle", type = "upper", tl.col = "black", tl.srt = 45, title = "Matriz de Correlación")
dev.off()
# Dividir en entrenamiento y prueba (70% - 30%)
set.seed(123)
trainIndex <- createDataPartition(data$card, p = .7,
list = FALSE,
times = 1)
dataTrain <- data[ trainIndex,]
dataTest  <- data[-trainIndex,]
# Ajustar Modelo de Regresión Logística Binomial
# Modelo completo con todas las variables
model <- glm(card ~ ., family = binomial(link = "logit"), data = dataTrain)
# Resumen del modelo
print("Resumen del Modelo de Regresión Logística:")
summary(model)
# Odds Ratios e Intervalos de Confianza
print("Odds Ratios (OR):")
exp(coef(model))
# Predicciones en el conjunto de prueba (probabilidades)
probabilities <- predict(model, newdata = dataTest, type = "response")
# Convertir probabilidades a clases (cutoff 0.5)
predictions <- ifelse(probabilities > 0.5, "yes", "no")
predictions <- as.factor(predictions)
# Asegurar mismos niveles
levels(predictions) <- levels(dataTest$card)
# Matriz de Confusión
cm <- confusionMatrix(predictions, dataTest$card)
print("Matriz de Confusión:")
print(cm)
# Curva ROC y AUC
roc_obj <- roc(dataTest$card, probabilities)
auc_value <- auc(roc_obj)
print(paste("Área bajo la curva (AUC):", auc_value))
# Graficar ROC
png("plot_roc.png")
plot(roc_obj, main = paste("Curva ROC (AUC =", round(auc_value, 4), ")"), col = "blue", lwd = 2)
dev.off()
# Análisis de Regresión Logística - Tarjetas de Crédito
# 1. Carga de Librerías y Datos -----------------------------------------------
# Instalar librerías si no existen (descomentar si es necesario)
# install.packages(c("ggplot2", "dplyr", "caret", "pROC", "corrplot"))
library(ggplot2)
library(dplyr)
library(caret)
library(pROC)
library(corrplot)
# Definir ruta del archivo (ajustar si es necesario)
ruta_csv <- "c:/Users/User/Documents/SEMESTRE IX/CIENCIA DE DATOS II/TARJETAS DE CREDITO/DatosAERcreditcarddataxlsx.csv"
# Cargar datos
data <- read.csv(ruta_csv)
# Vista preliminar
print("Primeras filas del dataset:")
head(data)
str(data)
# 2. Preprocesamiento y Limpieza ----------------------------------------------
# Convertir variables categóricas a factores
# La variable objetivo parece ser 'card' (yes/no)
data$card <- as.factor(data$card)
data$owner <- as.factor(data$owner)
data$selfemp <- as.factor(data$selfemp)
# Verificar valores nulos
print("Valores nulos por columna:")
colSums(is.na(data))
# Resumen estadístico
summary(data)
# 3. Análisis Exploratorio de Datos (EDA) -------------------------------------
# Distribución de la variable objetivo
g1 <- ggplot(data, aes(x = card, fill = card)) +
geom_bar() +
labs(title = "Distribución de la Variable Objetivo (Card)", x = "Aprobación de Tarjeta", y = "Conteo") +
theme_minimal()
print(g1)
# Relación Income vs Card
g2 <- ggplot(data, aes(x = card, y = income, fill = card)) +
geom_boxplot() +
labs(title = "Ingresos (Income) según Aprobación de Tarjeta", x = "Tarjeta", y = "Ingresos") +
theme_minimal()
print(g2)
# Relación Age vs Card
g3 <- ggplot(data, aes(x = card, y = age, fill = card)) +
geom_boxplot() +
labs(title = "Edad (Age) según Aprobación de Tarjeta", x = "Tarjeta", y = "Edad") +
theme_minimal()
print(g3)
# Correlaciones numéricas
numeric_vars <- data %>% select_if(is.numeric)
cor_matrix <- cor(numeric_vars)
corrplot(cor_matrix, method = "circle", type = "upper", tl.col = "black", tl.srt = 45, title = "Matriz de Correlación")
# 4. Modelado: Regresión Logística --------------------------------------------
# Dividir en entrenamiento y prueba (70% - 30%)
set.seed(123)
trainIndex <- createDataPartition(data$card, p = .7,
list = FALSE,
times = 1)
dataTrain <- data[ trainIndex,]
dataTest  <- data[-trainIndex,]
# Ajustar Modelo de Regresión Logística Binomial
# Modelo completo con todas las variables
model <- glm(card ~ ., family = binomial(link = "logit"), data = dataTrain)
# Resumen del modelo
print("Resumen del Modelo de Regresión Logística:")
summary(model)
# Odds Ratios e Intervalos de Confianza
print("Odds Ratios (OR):")
exp(coef(model))
# 5. Evaluación del Modelo ----------------------------------------------------
# Predicciones en el conjunto de prueba (probabilidades)
probabilities <- predict(model, newdata = dataTest, type = "response")
# Convertir probabilidades a clases (cutoff 0.5)
predictions <- ifelse(probabilities > 0.5, "yes", "no")
predictions <- as.factor(predictions)
# Asegurar mismos niveles
levels(predictions) <- levels(dataTest$card)
# Matriz de Confusión
cm <- confusionMatrix(predictions, dataTest$card)
print("Matriz de Confusión:")
print(cm)
# Curva ROC y AUC
roc_obj <- roc(dataTest$card, probabilities)
auc_value <- auc(roc_obj)
print(paste("Área bajo la curva (AUC):", auc_value))
# Graficar ROC
plot(roc_obj, main = paste("Curva ROC (AUC =", round(auc_value, 4), ")"), col = "blue", lwd = 2)
# Análisis de Regresión Logística - Tarjetas de Crédito
# 1. Carga de Librerías y Datos -----------------------------------------------
# Instalar librerías si no existen (descomentar si es necesario)
# install.packages(c("ggplot2", "dplyr", "caret", "pROC", "corrplot"))
library(ggplot2)
library(dplyr)
library(caret)
library(pROC)
library(corrplot)
# Definir ruta del archivo (ajustar si es necesario)
ruta_csv <- "c:/Users/User/Documents/SEMESTRE IX/CIENCIA DE DATOS II/TARJETAS DE CREDITO/DatosAERcreditcarddataxlsx.csv"
# Cargar datos
data <- read.csv(ruta_csv)
# Vista preliminar
print("Primeras filas del dataset:")
head(data)
str(data)
# 2. Preprocesamiento y Limpieza ----------------------------------------------
# Convertir variables categóricas a factores
# La variable objetivo parece ser 'card' (yes/no)
data$card <- as.factor(data$card)
data$owner <- as.factor(data$owner)
data$selfemp <- as.factor(data$selfemp)
# Verificar valores nulos
print("Valores nulos por columna:")
colSums(is.na(data))
# Resumen estadístico
summary(data)
# 3. Análisis Exploratorio de Datos (EDA) -------------------------------------
# Distribución de la variable objetivo
g1 <- ggplot(data, aes(x = card, fill = card)) +
geom_bar() +
labs(title = "Distribución de la Variable Objetivo (Card)", x = "Aprobación de Tarjeta", y = "Conteo") +
theme_minimal()
print(g1)
# Relación Income vs Card
g2 <- ggplot(data, aes(x = card, y = income, fill = card)) +
geom_boxplot() +
labs(title = "Ingresos (Income) según Aprobación de Tarjeta", x = "Tarjeta", y = "Ingresos") +
theme_minimal()
print(g2)
# Relación Age vs Card
g3 <- ggplot(data, aes(x = card, y = age, fill = card)) +
geom_boxplot() +
labs(title = "Edad (Age) según Aprobación de Tarjeta", x = "Tarjeta", y = "Edad") +
theme_minimal()
print(g3)
# Correlaciones numéricas
numeric_vars <- data %>% select_if(is.numeric)
cor_matrix <- cor(numeric_vars)
corrplot(cor_matrix, method = "circle", type = "upper", tl.col = "black", tl.srt = 45, title = "Matriz de Correlación")
# 4. Modelado: Regresión Logística --------------------------------------------
# Dividir en entrenamiento y prueba (70% - 30%)
set.seed(123)
trainIndex <- createDataPartition(data$card, p = .7,
list = FALSE,
times = 1)
dataTrain <- data[ trainIndex,]
dataTest  <- data[-trainIndex,]
# 4. Modelado: Regresión Logística --------------------------------------------
# Dividir en entrenamiento y prueba (70% - 30%)
set.seed(123)
trainIndex <- createDataPartition(data$card, p = .7,
list = FALSE,
times = 1)
dataTrain <- data[ trainIndex,]
dataTest  <- data[-trainIndex,]
# --- MODELO 1: REGRESIÓN LOGÍSTICA SIMPLE ---
# Variable Independiente determinante elegida: 'reports'
# Se elije 'reports' porque el historial negativo es usualmente determinante.
print("-----------------------------------------------------------------------")
print("MODELO 1: Regresión Logística SIMPLE (Variable: reports)")
print("-----------------------------------------------------------------------")
model_simple <- glm(card ~ reports, family = binomial(link = "logit"), data = dataTrain)
print(summary(model_simple))
# Evaluación Modelo Simple
prob_simple <- predict(model_simple, newdata = dataTest, type = "response")
pred_simple <- ifelse(prob_simple > 0.5, "yes", "no")
pred_simple <- factor(pred_simple, levels = levels(dataTest$card))
cm_simple <- confusionMatrix(pred_simple, dataTest$card, mode = "prec_recall") # mode='prec_recall' incluye Precision
print("Matriz de Confusión - Modelo Simple:")
print(cm_simple)
print(paste("Precisión (Positive Predictive Value) - Modelo Simple:", round(cm_simple$byClass['Precision'], 4)))
# --- MODELO 2: REGRESIÓN LOGÍSTICA MÚLTIPLE ---
# Considera TODAS las variables independientes
print("-----------------------------------------------------------------------")
print("MODELO 2: Regresión Logística MÚLTIPLE (Todas las variables)")
print("-----------------------------------------------------------------------")
model_multiple <- glm(card ~ ., family = binomial(link = "logit"), data = dataTrain)
print(summary(model_multiple))
# Evaluación Modelo Múltiple
prob_multiple <- predict(model_multiple, newdata = dataTest, type = "response")
pred_multiple <- ifelse(prob_multiple > 0.5, "yes", "no")
pred_multiple <- factor(pred_multiple, levels = levels(dataTest$card))
cm_multiple <- confusionMatrix(pred_multiple, dataTest$card, mode = "prec_recall")
print("Matriz de Confusión - Modelo Múltiple:")
print(cm_multiple)
print(paste("Precisión (Positive Predictive Value) - Modelo Múltiple:", round(cm_multiple$byClass['Precision'], 4)))
# 5. Comparación Curvas ROC ---------------------------------------------------
roc_simple <- roc(dataTest$card, prob_simple)
roc_multiple <- roc(dataTest$card, prob_multiple)
print(paste("AUC Modelo Simple:", round(auc(roc_simple), 4)))
print(paste("AUC Modelo Múltiple:", round(auc(roc_multiple), 4)))
plot(roc_simple, col = "red", main = "Curvas ROC: Simple (Rojo) vs Múltiple (Azul)")
lines(roc_multiple, col = "blue")
legend("bottomright", legend = c("Simple (reports)", "Múltiple (Todas)"), col = c("red", "blue"), lwd = 2)
View(data)
